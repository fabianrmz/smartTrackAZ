function addToFinal(){
    
}

function toXLXS() {
    var wb = XLSX.utils.book_new();
    wb.Props = {
        Title: "Datasheet 31/10/19",
        Subject: "Data retrieved from Firebase's Firestore",
        Author: "Autogenerated",
        CreatedDate: new Date(2019,10,31)
    }
    var feedbacksRef = db.collection("feedbacks");
    
    var final = [];
    //feedbacks data
    var fbLoc = ['Locations']; var fbBat = ['Batch']; var fbDate = ['Date']; var fbAss = ['Number of Assets']; var fbUid = ['User ID']; var fbValid = ['Cold assurance'];
    feedbacksRef.get().then(function (querySnapshot) {
        querySnapshot.forEach(function (doc) {
            console.log(doc.data());
            fbLoc.push(doc.data().locationId);
            fbBat.push(doc.data().lote);
            fbDate.push(doc.data().registerDate);
            fbAss.push(doc.data().totalAssets);
            fbUid.push(doc.data().userID);
            fbValid.push(doc.data().valid);
        })
        }).then(function() {
            
            final.push(fbBat);
            final.push(fbLoc);
            final.push(fbDate);
            final.push(fbAss);
            final.push(fbUid);
            final.push(fbValid);
            console.log(final);
            var ws = XLSX.utils.aoa_to_sheet(final);
    //wb.Sheets[wb.SheetNames[0]] = ws;
    XLSX.utils.book_append_sheet(wb, ws, "Feedback report");
    var wbout = XLSX.write(wb, {bookType:'xlsx',  type: 'binary'});
    saveAs(new Blob([s2ab(wbout)],{type:"application/octet-stream"}), 'test.xlsx');
    }).catch(function(error) {
        console.log("Error getting cached document:", error);
    });

    
}

function s2ab(s) { 
    var buf = new ArrayBuffer(s.length); //convert s to arrayBuffer
    var view = new Uint8Array(buf);  //create uint8array as viewer
    for (var i=0; i<s.length; i++) view[i] = s.charCodeAt(i) & 0xFF; //convert to octet
    return buf;    
}